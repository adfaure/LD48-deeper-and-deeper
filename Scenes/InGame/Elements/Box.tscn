[gd_scene load_steps=4 format=2]

[ext_resource path="res://Assets/icon.png" type="Texture" id=1]

[sub_resource type="GDScript" id=1]
script/source = "extends KinematicBody2D

var velocity = Vector2.ZERO
export (float) var gravity_scale = 5
export (Vector2) var rebound = Vector2(0,-150)

func _ready():
	pass

func _physics_process(delta):
	var snap = $PlatformDetector.cast_to

	var gravity= Vector2(0,98)
	velocity += gravity * delta * gravity_scale
	velocity = move_and_slide_with_snap(velocity,snap,Vector2.ZERO,true,4,0.9)
	velocity.x = 0

func push(direction: Vector2):
	velocity.x = direction.x
	if $CrateDetectorUp.is_colliding(): # pour pousser des caisses empilees
		var object = $CrateDetectorUp.get_collider()
		if object.is_in_group(\"Boxes\"):
			object.push(direction)
"

[sub_resource type="RectangleShape2D" id=2]
extents = Vector2( 41.3677, 38.5599 )

[node name="Box" type="KinematicBody2D" groups=[
"Boxes",
]]
script = SubResource( 1 )
gravity_scale = 1.0

[node name="Sprite" type="Sprite" parent="."]
position = Vector2( -0.0377472, 0.508322 )
scale = Vector2( 1.29082, 1.21403 )
texture = ExtResource( 1 )

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
shape = SubResource( 2 )

[node name="PlatformDetector" type="RayCast2D" parent="."]
enabled = true

[node name="CrateDetectorUp" type="RayCast2D" parent="."]
enabled = true
cast_to = Vector2( 0, -50 )
